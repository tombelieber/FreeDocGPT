from __future__ import annotations

from typing import Dict

import streamlit as st


# Minimal translation catalog (expand as needed)
SUPPORTED_LOCALES = ["en", "zh-Hant", "zh-Hans", "es", "ja"]


def normalize_locale(code: str | None) -> str:
    if not code:
        return "en"
    s = str(code).strip()
    if not s:
        return "en"
    l = s.lower().replace("_", "-")
    # Direct matches
    if l in ("en", "es", "ja", "zh-hant", "zh-hans"):
        return {"zh-hant": "zh-Hant", "zh-hans": "zh-Hans"}.get(l, l)
    # English
    if l.startswith("en"):
        return "en"
    # Spanish
    if l.startswith("es"):
        return "es"
    # Japanese
    if l.startswith("ja") or l.startswith("jp"):
        return "ja"
    # Chinese
    if l.startswith("zh"):
        if "hant" in l or any(x in l for x in ("tw", "hk", "mo")):
            return "zh-Hant"
        if "hans" in l or any(x in l for x in ("cn", "sg", "my")):
            return "zh-Hans"
        # default ambiguous zh to Traditional (can be adjusted)
        return "zh-Hant"
    # Fallback
    return "en"


_TRANSLATIONS: Dict[str, Dict[str, str]] = {
    "en": {
        "app.subtitle": "Free, local document buddy â€” drop files in `documents/` and start asking questions.",
        "sidebar.document_management": "ðŸ“ Document Management",
        "sidebar.documents_folder": "ðŸ“‚ Documents folder: `./{folder}/`",
        "sidebar.index_new_docs": "ðŸ”„ Index New Documents",
        "sidebar.found_docs": "Found {count} document(s)",
        "sidebar.auto_detect": "ðŸ¤– AI-Powered Auto-Detection",
        "sidebar.auto_detect_help": "Uses LLM to detect document types and languages.",
        "sidebar.auto_detect_caption1": "âœ¨ AI analyzes each document to tune processing",
        "sidebar.auto_detect_caption2": "ðŸŒ Supports English, ä¸­æ–‡ (ç®€/ç¹), EspaÃ±ol, æ—¥æœ¬èªž",
        "sidebar.no_docs_found": "No documents found in `./{folder}/`",
        "sidebar.supported_formats_title": "Supported formats:",
        "sidebar.vision_support_title": "ðŸŽ¨ Vision Support:",
        "sidebar.vision_support_detail": "âœ… PDF images, charts, and diagrams via LLaVA",
        "sidebar.indexed_docs": "ðŸ“Š Indexed Documents",
        "sidebar.reset_index": "ðŸ§¹ Reset Index",
        "sidebar.reset_index_help": "Drop LanceDB table and clear Tantivy index",
        "sidebar.no_index_yet": "No documents indexed yet",
        "sidebar.total_chunks": "Total Chunks",
        "sidebar.reset_ok": "Index reset completed.",
        "sidebar.reset_fail": "Failed to reset index. You can manually delete the .lancedb folder and reload.",
        "sidebar.tantivy_warn": "Tantivy clear warning: {err}",
        "search.header": "ðŸ” Search Settings",
        "search.mode": "Search Mode",
        "search.mode_help": "Choose search strategy: Hybrid combines keyword and vector search",
        "search.alpha_label": "Vector vs Keyword Weight",
        "search.alpha_help": "0 = Pure keyword search, 1 = Pure vector search, 0.5 = Balanced",
        "search.results_label": "Number of Results",
        "search.results_help": "Number of document chunks to retrieve",
        "search.weight_caption": "ðŸ“ Keyword: {kw}% | ðŸŽ¯ Vector: {vec}%",
        "chat.header": "ðŸ’¬ Ask Questions",
        "chat.input": "Ask a question about your documents...",
        "buttons.clear_chat": "ðŸ”„ Clear Chat",
        "chat.response_metrics": "ðŸ“Š Response Metrics",
        "chat.metrics_total_time": "Total time: {secs:.2f}s",
        "chat.metrics_first_token": "First token: {secs:.2f}s",
        "chat.metrics_tokens": "Tokens: {count}",
        "chat.metrics_speed": "Speed: {rate:.1f} tokens/sec",
        "footer.embedding_model": "Embedding Model:",
        "footer.generation_model": "Generation Model:",
        "chat.metric_response_time": "â±ï¸ Response Time",
        "chat.metric_first_token": "ðŸš€ First Token",
        "chat.metric_tokens": "ðŸ“ Tokens",
        "chat.metric_speed": "âš¡ Speed",
        "chat.searching": "ðŸ” Searching through documents...",
        "chat.found_chunks": "âœ… Found {count} relevant chunks in {secs:.2f}s",
        "chat.found_chunks_hybrid": " (Hybrid: {kw} keyword + {vec} vector)",
        "chat.found_chunks_keyword": " (Keyword: {kw} results)",
        "chat.found_chunks_vector": " (Vector: {vec} results)",
        "chat.sources": "ðŸ“– Sources",
        "chat.search_completed": "Search completed in {secs:.2f} seconds using {mode} mode",
        "chat.thinking": "ðŸ¤” Thinking...",
        "chat.streaming": "ðŸ”„ Streaming...",
        "chat.complete": "âœ… Complete",
        "chat.error_generating": "Error generating response: {err}",
        "chat.no_relevant": "I couldn't find any relevant information in the indexed documents. Please make sure documents are indexed.",
        "chat.no_relevant_title": "âš ï¸ No relevant documents found",
        "lang.selector": "ðŸŒ Language / èªžè¨€ / è¯­è¨€",
        "lang.en": "English",
        "lang.zh_hant": "ç¹é«”ä¸­æ–‡",
        "lang.zh_hans": "ç®€ä½“ä¸­æ–‡",
        "lang.es": "EspaÃ±ol",
        "lang.ja": "æ—¥æœ¬èªž",

        # Settings panel
        "settings.title": "âš™ï¸ Settings",
        "settings.doc_processing": "ðŸ“Š Document Processing Settings",
        "settings.quick_presets": "ðŸŽ¯ Quick Presets",
        "settings.quick_presets_caption": "Optimized for common docs: Notion/Lark exports, PDFs, tech docs",
        "settings.preset_meeting": "ðŸ“ Meeting Notes",
        "settings.preset_prd": "ðŸ“‹ PRD/Specs",
        "settings.preset_tech": "ðŸ’» Tech Docs",
        "settings.preset_wiki": "ðŸ“š Wiki/KB",
        "settings.preset_applied_meeting": "ðŸ“ Applied Meeting Notes preset",
        "settings.preset_applied_prd": "ðŸ“‹ Applied PRD/Specs preset",
        "settings.preset_applied_tech": "ðŸ’» Applied Tech Docs preset",
        "settings.preset_applied_wiki": "ðŸ“š Applied Wiki/KB preset",
        "settings.chunk_size": "ðŸ“ Chunk Size (characters per segment)",
        "settings.chunk_help": "For Notion/Lark docs with mixed content, 1500-1800 is recommended.",
        "settings.overlap_size": "ðŸ”„ Overlap Size (shared text between chunks)",
        "settings.overlap_help": "For documents with code blocks, use 300-400.",
        "settings.results": "ðŸ” Search Results (number of relevant segments)",
        "settings.results_help": "For technical queries use 5-7, for simple Q&A use 3-5.",
        "settings.current_config": "ðŸ“Š Current Configuration",
        "settings.metric_chunk": "Chunk Size",
        "settings.metric_overlap": "Overlap",
        "settings.metric_results": "Results",
        "settings.small_good": "âš ï¸ Small: Good for Q&A",
        "settings.large_good": "ðŸ“¦ Large: Good for code",
        "settings.balanced": "âœ… Balanced",
        "settings.overlap_pct": "{pct:.0f}% of chunk size",
        "settings.focused": "ðŸŽ¯ Focused search",
        "settings.comprehensive": "ðŸŒ Comprehensive",
        "settings.best_practices": "ðŸ’¡ Best Practices",
        "settings.bp_notion_title": "ðŸ“Œ For Notion/Lark Export:",
        "settings.bp_notion_list": "- Export as Markdown (.md) for best results\n- Notion: Settings â†’ Export â†’ Markdown & CSV\n- Lark/Feishu: More â†’ Export â†’ Markdown",
        "settings.bp_reco_title": "ðŸ“Š Recommended Settings:",
        "settings.bp_reco_list": "- Meeting Notes: 600-800 chunk, 100 overlap\n- PRD/Specs: 1500 chunk, 300 overlap\n- Tech Docs: 1800 chunk, 400 overlap\n- Wiki/How-to: 1200 chunk, 200 overlap",
        "settings.prompt": "Prompt",
        "settings.prompt_active": "Active system prompt file:",
        "settings.preview_first300": "Preview first 300 chars",
        "settings.prompt_not_found": "Prompt file not found; using default built-in prompt.",
        "settings.prompt_could_not_read": "Could not read prompt file: {err}",
        "settings.reload_prompt": "ðŸ” Reload System Prompt",
        "settings.reload_ok": "System prompt reloaded.",
        "settings.reload_fail": "Failed to reload prompt: {err}",
        "settings.reload_na": "Search service not available to reload prompt.",
        "settings.models": "Models",
        "settings.ollama_prereq": "âš ï¸ Prerequisites Required:\n1. Install Ollama: `brew install ollama`\n2. Start Ollama: `ollama serve`\n3. Pull required models:\n   - `ollama pull embeddinggemma:300m`\n   - `ollama pull gpt-oss:20b`",
        "settings.embed_model": "Embedding Model",
        "settings.gen_model": "Generation Model",
        "settings.model_help": "Make sure this model is installed in Ollama",
        "settings.check_ollama": "ðŸ” Check Ollama Status",
    },
    "zh-Hant": {
        "app.subtitle": "å…è²»ã€æœ¬åœ°çš„æ–‡ä»¶å¤¥ä¼´â€”â€”æŠŠæª”æ¡ˆæ”¾é€² `documents/` å°±èƒ½é–‹å§‹ç™¼å•ã€‚",
        "sidebar.document_management": "ðŸ“ æª”æ¡ˆç®¡ç†",
        "sidebar.documents_folder": "ðŸ“‚ æª”æ¡ˆè³‡æ–™å¤¾ï¼š`./{folder}/`",
        "sidebar.index_new_docs": "ðŸ”„ å»ºç«‹æ–°ç´¢å¼•",
        "sidebar.found_docs": "æ‰¾åˆ° {count} ä»½æª”æ¡ˆ",
        "sidebar.auto_detect": "ðŸ¤– AI æ™ºèƒ½è‡ªå‹•è¾¨è­˜",
        "sidebar.auto_detect_help": "ä½¿ç”¨ LLM è¾¨è­˜æ–‡ä»¶é¡žåž‹èˆ‡èªžè¨€ã€‚",
        "sidebar.auto_detect_caption1": "âœ¨ AI æœƒåˆ†æžæ¯ä»½æª”æ¡ˆä¸¦è‡ªå‹•èª¿æ•´è™•ç†è¨­å®š",
        "sidebar.auto_detect_caption2": "ðŸŒ æ”¯æ´ English / ç®€ä½“ä¸­æ–‡ / ç¹é«”ä¸­æ–‡ / EspaÃ±ol / æ—¥æœ¬èªž åŠæ··åˆå…§å®¹",
        "sidebar.no_docs_found": "åœ¨ `./{folder}/` æ‰¾ä¸åˆ°æª”æ¡ˆ",
        "sidebar.supported_formats_title": "æ”¯æ´æ ¼å¼ï¼š",
        "sidebar.vision_support_title": "ðŸŽ¨ å½±åƒè¾¨è­˜ï¼š",
        "sidebar.vision_support_detail": "âœ… é€éŽ LLaVA è™•ç† PDF åœ–åƒã€åœ–è¡¨èˆ‡æˆªåœ–",
        "sidebar.supported_formats_list": "PDFã€Wordã€Markdownã€HTMLã€CSVã€Excelã€JSONã€TXT ç­‰",
        "sidebar.indexed_docs": "ðŸ“Š å·²ç´¢å¼•æª”æ¡ˆ",
        "sidebar.reset_index": "ðŸ§¹ é‡è¨­ç´¢å¼•",
        "sidebar.reset_index_help": "æ¸…é™¤ LanceDB è³‡æ–™è¡¨ä¸¦é‡ç½® Tantivy ç´¢å¼•",
        "sidebar.no_index_yet": "å°šæœªå»ºç«‹ä»»ä½•ç´¢å¼•",
        "sidebar.total_chunks": "ç¸½ç‰‡æ®µæ•¸",
        "sidebar.reset_ok": "ç´¢å¼•å·²é‡è¨­ã€‚",
        "sidebar.reset_fail": "é‡è¨­å¤±æ•—ã€‚ä½ ä¹Ÿå¯ä»¥æ‰‹å‹•åˆªé™¤ .lancedb è³‡æ–™å¤¾å¾Œé‡æ–°è¼‰å…¥ã€‚",
        "sidebar.tantivy_warn": "Tantivy æ¸…é™¤è­¦å‘Šï¼š{err}",
        "search.header": "ðŸ” æœå°‹è¨­å®š",
        "search.mode": "æœå°‹æ¨¡å¼",
        "search.mode_help": "æ··åˆæœå°‹åŒæ™‚ä½¿ç”¨é—œéµå­—èˆ‡å‘é‡ï¼Œæ¯”è¼ƒè°æ˜Ž",
        "search.alpha_label": "å‘é‡ vs é—œéµå­— æ¬Šé‡",
        "search.alpha_help": "0 = ç´”é—œéµå­—ï¼Œ1 = ç´”å‘é‡ï¼Œ0.5 = å¹³è¡¡",
        "search.results_label": "çµæžœæ•¸é‡",
        "search.results_help": "è¦æ“·å–çš„æ–‡ä»¶ç‰‡æ®µæ•¸é‡",
        "search.weight_caption": "ðŸ“ é—œéµå­—ï¼š{kw}% ï½œ ðŸŽ¯ å‘é‡ï¼š{vec}%",
        "chat.header": "ðŸ’¬ æå•",
        "chat.input": "å°±ä½ çš„æª”æ¡ˆæå‡ºå•é¡Œâ€¦",
        "buttons.clear_chat": "ðŸ”„ æ¸…é™¤å°è©±",
        "chat.response_metrics": "ðŸ“Š å›žæ‡‰æŒ‡æ¨™",
        "chat.metrics_total_time": "ç¸½æ™‚é–“ï¼š{secs:.2f} ç§’",
        "chat.metrics_first_token": "ç¬¬ä¸€å€‹ Tokenï¼š{secs:.2f} ç§’",
        "chat.metrics_tokens": "Token æ•¸ï¼š{count}",
        "chat.metrics_speed": "é€Ÿåº¦ï¼š{rate:.1f} tokens/sec",
        "footer.embedding_model": "Embedding æ¨¡åž‹ï¼š",
        "footer.generation_model": "ç”Ÿæˆæ¨¡åž‹ï¼š",
        "chat.metric_response_time": "â±ï¸ å›žæ‡‰æ™‚é–“",
        "chat.metric_first_token": "ðŸš€ ç¬¬ä¸€å€‹ Token",
        "chat.metric_tokens": "ðŸ“ Token æ•¸",
        "chat.metric_speed": "âš¡ é€Ÿåº¦",
        "chat.searching": "ðŸ” æ­£åœ¨æœå°‹æª”æ¡ˆâ€¦",
        "chat.found_chunks": "âœ… æ‰¾åˆ° {count} å€‹ç›¸é—œç‰‡æ®µï¼Œç”¨æ™‚ {secs:.2f} ç§’",
        "chat.found_chunks_hybrid": "ï¼ˆæ··åˆï¼š{kw} é—œéµå­— + {vec} å‘é‡ï¼‰",
        "chat.found_chunks_keyword": "ï¼ˆé—œéµå­—ï¼š{kw} ç­†ï¼‰",
        "chat.found_chunks_vector": "ï¼ˆå‘é‡ï¼š{vec} ç­†ï¼‰",
        "chat.sources": "ðŸ“– ä¾†æº",
        "chat.search_completed": "æœå°‹å®Œæˆï¼Œç”¨æ™‚ {secs:.2f} ç§’ï¼Œæ¨¡å¼ï¼š{mode}",
        "chat.thinking": "ðŸ¤” æ€è€ƒä¸­â€¦",
        "chat.streaming": "ðŸ”„ ä¸²æµä¸­â€¦",
        "chat.complete": "âœ… å®Œæˆ",
        "chat.error_generating": "ç”¢ç”Ÿå›žæ‡‰æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š{err}",
        "chat.no_relevant": "æ‰¾ä¸åˆ°ç›¸é—œå…§å®¹ï¼Œè«‹å…ˆç¢ºèªå·²ç´¢å¼•æª”æ¡ˆã€‚",
        "chat.no_relevant_title": "âš ï¸ æ‰¾ä¸åˆ°ç›¸é—œæ–‡ä»¶",
        "lang.selector": "ðŸŒ èªžè¨€",
        "lang.en": "English",
        "lang.zh_hant": "ç¹é«”ä¸­æ–‡",
        "lang.zh_hans": "ç®€ä½“ä¸­æ–‡",
        "lang.es": "è¥¿ç­ç‰™æ–‡",
        "lang.ja": "æ—¥æ–‡",

        "settings.title": "âš™ï¸ è¨­å®š",
        "settings.doc_processing": "ðŸ“Š æ–‡ä»¶è™•ç†è¨­å®š",
        "settings.quick_presets": "ðŸŽ¯ å¿«é€Ÿé è¨­",
        "settings.quick_presets_caption": "æœ€ä½³åŒ–å¸¸è¦‹æ–‡ä»¶ï¼šNotion/é£›æ›¸åŒ¯å‡ºã€PDFã€æŠ€è¡“æ–‡ä»¶",
        "settings.preset_meeting": "ðŸ“ æœƒè­°ç´€éŒ„",
        "settings.preset_prd": "ðŸ“‹ PRD/è¦æ ¼",
        "settings.preset_tech": "ðŸ’» æŠ€è¡“æ–‡ä»¶",
        "settings.preset_wiki": "ðŸ“š Wiki/çŸ¥è­˜åº«",
        "settings.preset_applied_meeting": "ðŸ“ å·²å¥—ç”¨ï¼šæœƒè­°ç´€éŒ„",
        "settings.preset_applied_prd": "ðŸ“‹ å·²å¥—ç”¨ï¼šPRD/è¦æ ¼",
        "settings.preset_applied_tech": "ðŸ’» å·²å¥—ç”¨ï¼šæŠ€è¡“æ–‡ä»¶",
        "settings.preset_applied_wiki": "ðŸ“š å·²å¥—ç”¨ï¼šWiki/çŸ¥è­˜åº«",
        "settings.chunk_size": "ðŸ“ ç‰‡æ®µå¤§å°ï¼ˆæ¯æ®µå­—å…ƒæ•¸ï¼‰",
        "settings.chunk_help": "æ··åˆå…§å®¹å»ºè­° 1500â€“1800ã€‚",
        "settings.overlap_size": "ðŸ”„ é‡ç–Šå¤§å°ï¼ˆç‰‡æ®µé–“å…±ç”¨æ–‡å­—ï¼‰",
        "settings.overlap_help": "å«ç¨‹å¼ç¢¼å€å¡Šçš„æ–‡ä»¶å»ºè­° 300â€“400ã€‚",
        "settings.results": "ðŸ” æœå°‹çµæžœæ•¸ï¼ˆç›¸é—œç‰‡æ®µæ•¸é‡ï¼‰",
        "settings.results_help": "æŠ€è¡“å•é¡Œç”¨ 5â€“7ï¼Œç°¡å–®å•ç­”ç”¨ 3â€“5ã€‚",
        "settings.current_config": "ðŸ“Š ç›®å‰è¨­å®š",
        "settings.metric_chunk": "ç‰‡æ®µå¤§å°",
        "settings.metric_overlap": "é‡ç–Š",
        "settings.metric_results": "çµæžœ",
        "settings.small_good": "âš ï¸ å°ï¼šé©åˆå•ç­”",
        "settings.large_good": "ðŸ“¦ å¤§ï¼šé©åˆç¨‹å¼ç¢¼",
        "settings.balanced": "âœ… å¹³è¡¡",
        "settings.overlap_pct": "é‡ç–Šå æ¯” {pct:.0f}%",
        "settings.focused": "ðŸŽ¯ ç²¾æº–æœå°‹",
        "settings.comprehensive": "ðŸŒ å…¨é¢",
        "settings.best_practices": "ðŸ’¡ æœ€ä½³å¯¦å‹™",
        "settings.bp_notion_title": "ðŸ“Œ Notion/é£›æ›¸åŒ¯å‡ºï¼š",
        "settings.bp_notion_list": "- è«‹åŒ¯å‡ºç‚º Markdownï¼ˆ.mdï¼‰\n- Notionï¼šSettings â†’ Export â†’ Markdown & CSV\n- é£›æ›¸/Feishu/Larkï¼šæ›´å¤š â†’ åŒ¯å‡º â†’ Markdown",
        "settings.bp_reco_title": "ðŸ“Š å»ºè­°è¨­å®šï¼š",
        "settings.bp_reco_list": "- æœƒè­°ç´€éŒ„ï¼š600â€“800ï¼Œé‡ç–Š 100\n- PRD/è¦æ ¼ï¼š1500ï¼Œé‡ç–Š 300\n- æŠ€è¡“æ–‡ä»¶ï¼š1800ï¼Œé‡ç–Š 400\n- Wiki/æ•™å­¸ï¼š1200ï¼Œé‡ç–Š 200",
        "settings.prompt": "æç¤ºè©žï¼ˆPromptï¼‰",
        "settings.prompt_active": "ä½¿ç”¨ä¸­çš„ç³»çµ±æç¤ºæª”ï¼š",
        "settings.preview_first300": "é è¦½å‰ 300 å­—",
        "settings.prompt_not_found": "æ‰¾ä¸åˆ°æç¤ºæª”ï¼›æ”¹ç”¨å…§å»ºé è¨­ã€‚",
        "settings.prompt_could_not_read": "ç„¡æ³•è®€å–æç¤ºæª”ï¼š{err}",
        "settings.reload_prompt": "ðŸ” é‡æ–°è¼‰å…¥ç³»çµ±æç¤º",
        "settings.reload_ok": "å·²é‡æ–°è¼‰å…¥ã€‚",
        "settings.reload_fail": "é‡æ–°è¼‰å…¥å¤±æ•—ï¼š{err}",
        "settings.reload_na": "ç›®å‰ç„¡æ³•é‡æ–°è¼‰å…¥æç¤ºã€‚",
        "settings.models": "æ¨¡åž‹",
        "settings.ollama_prereq": "âš ï¸ éœ€è¦å…ˆæº–å‚™ï¼š\n1. å®‰è£ Ollamaï¼š`brew install ollama`\n2. å•Ÿå‹•ï¼š`ollama serve`\n3. ä¸‹è¼‰æ¨¡åž‹ï¼š\n   - `ollama pull embeddinggemma:300m`\n   - `ollama pull gpt-oss:20b`",
        "settings.embed_model": "Embedding æ¨¡åž‹",
        "settings.gen_model": "ç”Ÿæˆæ¨¡åž‹",
        "settings.model_help": "è«‹å…ˆåœ¨ Ollama å®‰è£è©²æ¨¡åž‹",
        "settings.check_ollama": "ðŸ” æª¢æŸ¥ Ollama ç‹€æ…‹",
    },
    "zh-Hans": {
        "app.subtitle": "å…è´¹ã€æœ¬åœ°çš„æ–‡ä»¶ä¼™ä¼´â€”â€”æŠŠæ–‡ä»¶æ”¾è¿› `documents/` å°±èƒ½å¼€å§‹æé—®ã€‚",
        "sidebar.document_management": "ðŸ“ æ–‡ä»¶ç®¡ç†",
        "sidebar.documents_folder": "ðŸ“‚ æ–‡ä»¶å¤¹ï¼š`./{folder}/`",
        "sidebar.index_new_docs": "ðŸ”„ å»ºç«‹æ–°ç´¢å¼•",
        "sidebar.found_docs": "æ‰¾åˆ° {count} ä¸ªæ–‡ä»¶",
        "sidebar.auto_detect": "ðŸ¤– AI æ™ºèƒ½è‡ªåŠ¨è¯†åˆ«",
        "sidebar.auto_detect_help": "ä½¿ç”¨ LLM è¯†åˆ«æ–‡æ¡£ç±»åž‹ä¸Žè¯­è¨€ã€‚",
        "sidebar.auto_detect_caption1": "âœ¨ AI ä¼šåˆ†æžæ¯ä¸ªæ–‡ä»¶å¹¶è‡ªåŠ¨è°ƒæ•´å¤„ç†è®¾ç½®",
        "sidebar.auto_detect_caption2": "ðŸŒ æ”¯æŒ English / ç®€ä½“ä¸­æ–‡ / ç¹é«”ä¸­æ–‡ / EspaÃ±ol / æ—¥æœ¬èªž åŠæ··åˆå†…å®¹",
        "sidebar.no_docs_found": "åœ¨ `./{folder}/` æ‰¾ä¸åˆ°æ–‡ä»¶",
        "sidebar.supported_formats_title": "æ”¯æŒæ ¼å¼ï¼š",
        "sidebar.vision_support_title": "ðŸŽ¨ å›¾åƒè¯†åˆ«ï¼š",
        "sidebar.vision_support_detail": "âœ… é€šè¿‡ LLaVA å¤„ç† PDF å›¾ç‰‡ã€å›¾è¡¨ä¸Žæˆªå›¾",
        "sidebar.supported_formats_list": "PDFã€Wordã€Markdownã€HTMLã€CSVã€Excelã€JSONã€TXT ç­‰",
        "sidebar.indexed_docs": "ðŸ“Š å·²ç´¢å¼•æ–‡ä»¶",
        "sidebar.reset_index": "ðŸ§¹ é‡ç½®ç´¢å¼•",
        "sidebar.reset_index_help": "æ¸…é™¤ LanceDB è¡¨å¹¶é‡ç½® Tantivy ç´¢å¼•",
        "sidebar.no_index_yet": "å°šæœªå»ºç«‹ä»»ä½•ç´¢å¼•",
        "sidebar.total_chunks": "æ€»ç‰‡æ®µæ•°",
        "sidebar.reset_ok": "ç´¢å¼•å·²é‡ç½®ã€‚",
        "sidebar.reset_fail": "é‡ç½®å¤±è´¥ã€‚ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ é™¤ .lancedb æ–‡ä»¶å¤¹åŽé‡æ–°åŠ è½½ã€‚",
        "sidebar.tantivy_warn": "Tantivy æ¸…é™¤è­¦å‘Šï¼š{err}",
        "search.header": "ðŸ” æœç´¢è®¾ç½®",
        "search.mode": "æœç´¢æ¨¡å¼",
        "search.mode_help": "æ··åˆæœç´¢ç»“åˆå…³é”®å­—ä¸Žå‘é‡ï¼Œæ›´èªæ˜Ž",
        "search.alpha_label": "å‘é‡ vs å…³é”®å­— æƒé‡",
        "search.alpha_help": "0 = çº¯å…³é”®å­—ï¼Œ1 = çº¯å‘é‡ï¼Œ0.5 = å¹³è¡¡",
        "search.results_label": "ç»“æžœæ•°é‡",
        "search.results_help": "è¦èŽ·å–çš„æ–‡æ¡£ç‰‡æ®µæ•°é‡",
        "search.weight_caption": "ðŸ“ å…³é”®å­—ï¼š{kw}% ï½œ ðŸŽ¯ å‘é‡ï¼š{vec}%",
        "chat.header": "ðŸ’¬ æé—®",
        "chat.input": "å°±ä½ çš„æ–‡ä»¶æå‡ºé—®é¢˜â€¦",
        "buttons.clear_chat": "ðŸ”„ æ¸…é™¤å¯¹è¯",
        "chat.response_metrics": "ðŸ“Š å“åº”æŒ‡æ ‡",
        "chat.metrics_total_time": "æ€»æ—¶é—´ï¼š{secs:.2f} ç§’",
        "chat.metrics_first_token": "ç¬¬ä¸€ä¸ª Tokenï¼š{secs:.2f} ç§’",
        "chat.metrics_tokens": "Token æ•°ï¼š{count}",
        "chat.metrics_speed": "é€Ÿåº¦ï¼š{rate:.1f} tokens/sec",
        "footer.embedding_model": "Embedding æ¨¡åž‹ï¼š",
        "footer.generation_model": "ç”Ÿæˆæ¨¡åž‹ï¼š",
        "chat.metric_response_time": "â±ï¸ å“åº”æ—¶é—´",
        "chat.metric_first_token": "ðŸš€ ç¬¬ä¸€ä¸ª Token",
        "chat.metric_tokens": "ðŸ“ Token æ•°",
        "chat.metric_speed": "âš¡ é€Ÿåº¦",
        "chat.searching": "ðŸ” æ­£åœ¨æœç´¢æ–‡ä»¶â€¦",
        "chat.found_chunks": "âœ… æ‰¾åˆ° {count} ä¸ªç›¸å…³ç‰‡æ®µï¼Œç”¨æ—¶ {secs:.2f} ç§’",
        "chat.found_chunks_hybrid": "ï¼ˆæ··åˆï¼š{kw} å…³é”®å­— + {vec} å‘é‡ï¼‰",
        "chat.found_chunks_keyword": "ï¼ˆå…³é”®å­—ï¼š{kw} æ¡ï¼‰",
        "chat.found_chunks_vector": "ï¼ˆå‘é‡ï¼š{vec} æ¡ï¼‰",
        "chat.sources": "ðŸ“– æ¥æº",
        "chat.search_completed": "æœç´¢å®Œæˆï¼Œç”¨æ—¶ {secs:.2f} ç§’ï¼Œæ¨¡å¼ï¼š{mode}",
        "chat.thinking": "ðŸ¤” æ€è€ƒä¸­â€¦",
        "chat.streaming": "ðŸ”„ æµå¼è¾“å‡ºä¸­â€¦",
        "chat.complete": "âœ… å®Œæˆ",
        "chat.error_generating": "ç”Ÿæˆå›žç­”æ—¶å‘ç”Ÿé”™è¯¯ï¼š{err}",
        "chat.no_relevant": "æ‰¾ä¸åˆ°ç›¸å…³å†…å®¹ï¼Œè¯·å…ˆç¡®è®¤å·²å»ºç«‹ç´¢å¼•ã€‚",
        "chat.no_relevant_title": "âš ï¸ æ‰¾ä¸åˆ°ç›¸å…³æ–‡ä»¶",
        "lang.selector": "ðŸŒ è¯­è¨€",
        "lang.en": "English",
        "lang.zh_hant": "ç¹é«”ä¸­æ–‡",
        "lang.zh_hans": "ç®€ä½“ä¸­æ–‡",
        "lang.es": "è¥¿ç­ç‰™è¯­",
        "lang.ja": "æ—¥è¯­",

        "settings.title": "âš™ï¸ è®¾ç½®",
        "settings.doc_processing": "ðŸ“Š æ–‡æ¡£å¤„ç†è®¾ç½®",
        "settings.quick_presets": "ðŸŽ¯ å¿«é€Ÿé¢„è®¾",
        "settings.quick_presets_caption": "ä¼˜åŒ–å¸¸è§æ–‡æ¡£ï¼šNotion/é£žä¹¦å¯¼å‡ºã€PDFã€æŠ€æœ¯æ–‡æ¡£",
        "settings.preset_meeting": "ðŸ“ ä¼šè®®è®°å½•",
        "settings.preset_prd": "ðŸ“‹ PRD/è§„æ ¼",
        "settings.preset_tech": "ðŸ’» æŠ€æœ¯æ–‡æ¡£",
        "settings.preset_wiki": "ðŸ“š Wiki/çŸ¥è¯†åº“",
        "settings.preset_applied_meeting": "ðŸ“ å·²åº”ç”¨ï¼šä¼šè®®è®°å½•",
        "settings.preset_applied_prd": "ðŸ“‹ å·²åº”ç”¨ï¼šPRD/è§„æ ¼",
        "settings.preset_applied_tech": "ðŸ’» å·²åº”ç”¨ï¼šæŠ€æœ¯æ–‡æ¡£",
        "settings.preset_applied_wiki": "ðŸ“š å·²åº”ç”¨ï¼šWiki/çŸ¥è¯†åº“",
        "settings.chunk_size": "ðŸ“ ç‰‡æ®µå¤§å°ï¼ˆæ¯æ®µå­—ç¬¦æ•°ï¼‰",
        "settings.chunk_help": "æ··åˆå†…å®¹æŽ¨è 1500â€“1800ã€‚",
        "settings.overlap_size": "ðŸ”„ é‡å å¤§å°ï¼ˆç‰‡æ®µé—´å…±äº«æ–‡æœ¬ï¼‰",
        "settings.overlap_help": "å«ä»£ç å—çš„æ–‡æ¡£æŽ¨è 300â€“400ã€‚",
        "settings.results": "ðŸ” æœç´¢ç»“æžœæ•°ï¼ˆç›¸å…³ç‰‡æ®µæ•°é‡ï¼‰",
        "settings.results_help": "æŠ€æœ¯é—®é¢˜ç”¨ 5â€“7ï¼Œç®€å•é—®ç­”ç”¨ 3â€“5ã€‚",
        "settings.current_config": "ðŸ“Š å½“å‰è®¾ç½®",
        "settings.metric_chunk": "ç‰‡æ®µå¤§å°",
        "settings.metric_overlap": "é‡å ",
        "settings.metric_results": "ç»“æžœ",
        "settings.small_good": "âš ï¸ å°ï¼šé€‚åˆé—®ç­”",
        "settings.large_good": "ðŸ“¦ å¤§ï¼šé€‚åˆä»£ç ",
        "settings.balanced": "âœ… å¹³è¡¡",
        "settings.overlap_pct": "é‡å å æ¯” {pct:.0f}%",
        "settings.focused": "ðŸŽ¯ ç²¾å‡†æœç´¢",
        "settings.comprehensive": "ðŸŒ å…¨é¢",
        "settings.best_practices": "ðŸ’¡ æœ€ä½³å®žè·µ",
        "settings.bp_notion_title": "ðŸ“Œ Notion/é£žä¹¦å¯¼å‡ºï¼š",
        "settings.bp_notion_list": "- è¯·å¯¼å‡ºä¸º Markdownï¼ˆ.mdï¼‰\n- Notionï¼šSettings â†’ Export â†’ Markdown & CSV\n- é£žä¹¦/Feishu/Larkï¼šæ›´å¤š â†’ å¯¼å‡º â†’ Markdown",
        "settings.bp_reco_title": "ðŸ“Š å»ºè®®è®¾ç½®ï¼š",
        "settings.bp_reco_list": "- ä¼šè®®è®°å½•ï¼š600â€“800ï¼Œé‡å  100\n- PRD/è§„æ ¼ï¼š1500ï¼Œé‡å  300\n- æŠ€æœ¯æ–‡æ¡£ï¼š1800ï¼Œé‡å  400\n- Wiki/æ•™ç¨‹ï¼š1200ï¼Œé‡å  200",
        "settings.prompt": "æç¤ºè¯ï¼ˆPromptï¼‰",
        "settings.prompt_active": "ä½¿ç”¨ä¸­çš„ç³»ç»Ÿæç¤ºæ–‡ä»¶ï¼š",
        "settings.preview_first300": "é¢„è§ˆå‰ 300 å­—",
        "settings.prompt_not_found": "æ‰¾ä¸åˆ°æç¤ºæ–‡ä»¶ï¼›æ”¹ç”¨å†…ç½®é»˜è®¤ã€‚",
        "settings.prompt_could_not_read": "æ— æ³•è¯»å–æç¤ºæ–‡ä»¶ï¼š{err}",
        "settings.reload_prompt": "ðŸ” é‡æ–°åŠ è½½ç³»ç»Ÿæç¤º",
        "settings.reload_ok": "å·²é‡æ–°åŠ è½½ã€‚",
        "settings.reload_fail": "é‡æ–°åŠ è½½å¤±è´¥ï¼š{err}",
        "settings.reload_na": "ç›®å‰æ— æ³•é‡æ–°åŠ è½½æç¤ºã€‚",
        "settings.models": "æ¨¡åž‹",
        "settings.ollama_prereq": "âš ï¸ éœ€è¦å…ˆå‡†å¤‡ï¼š\n1. å®‰è£… Ollamaï¼š`brew install ollama`\n2. å¯åŠ¨ï¼š`ollama serve`\n3. ä¸‹è½½æ¨¡åž‹ï¼š\n   - `ollama pull embeddinggemma:300m`\n   - `ollama pull gpt-oss:20b`",
        "settings.embed_model": "Embedding æ¨¡åž‹",
        "settings.gen_model": "ç”Ÿæˆæ¨¡åž‹",
        "settings.model_help": "è¯·å…ˆåœ¨ Ollama å®‰è£…è¯¥æ¨¡åž‹",
        "settings.check_ollama": "ðŸ” æ£€æŸ¥ Ollama çŠ¶æ€",
    },
    "es": {
        "app.subtitle": "CompaÃ±ero local y gratuito para tus documentos â€” pon archivos en `documents/` y pregunta al instante.",
        "sidebar.document_management": "ðŸ“ GestiÃ³n de Documentos",
        "sidebar.documents_folder": "ðŸ“‚ Carpeta de documentos: `./{folder}/`",
        "sidebar.index_new_docs": "ðŸ”„ Indexar nuevos documentos",
        "sidebar.found_docs": "Se encontraron {count} documento(s)",
        "sidebar.auto_detect": "ðŸ¤– DetecciÃ³n automÃ¡tica con IA",
        "sidebar.auto_detect_help": "Usa un LLM para detectar tipos e idiomas de documentos.",
        "sidebar.auto_detect_caption1": "âœ¨ La IA analiza cada documento para ajustar el procesamiento",
        "sidebar.auto_detect_caption2": "ðŸŒ Compatible con English, ä¸­æ–‡ (ç®€/ç¹), EspaÃ±ol, æ—¥æœ¬èªž",
        "sidebar.no_docs_found": "No se encontraron documentos en `./{folder}/`",
        "sidebar.supported_formats_title": "Formatos compatibles:",
        "sidebar.vision_support_title": "ðŸŽ¨ Soporte de visiÃ³n:",
        "sidebar.vision_support_detail": "âœ… ImÃ¡genes, grÃ¡ficos y capturas en PDF (LLaVA)",
        "sidebar.supported_formats_list": "PDF, Word, Markdown, HTML, CSV, Excel, JSON, TXT, etc.",
        "sidebar.indexed_docs": "ðŸ“Š Documentos indexados",
        "sidebar.reset_index": "ðŸ§¹ Reiniciar Ã­ndice",
        "sidebar.reset_index_help": "Eliminar la tabla de LanceDB y limpiar el Ã­ndice Tantivy",
        "sidebar.no_index_yet": "AÃºn no hay documentos indexados",
        "sidebar.total_chunks": "Fragmentos totales",
        "sidebar.reset_ok": "Ãndice reiniciado correctamente.",
        "sidebar.reset_fail": "Error al reiniciar. Puedes borrar la carpeta .lancedb y recargar.",
        "sidebar.tantivy_warn": "Advertencia al limpiar Tantivy: {err}",
        "search.header": "ðŸ” ConfiguraciÃ³n de bÃºsqueda",
        "search.mode": "Modo de bÃºsqueda",
        "search.mode_help": "HÃ­brido combina palabras clave y bÃºsqueda vectorial",
        "search.alpha_label": "Peso: Vector vs Palabras clave",
        "search.alpha_help": "0 = Solo palabras clave, 1 = Solo vectorial, 0.5 = Balanceado",
        "search.results_label": "NÃºmero de resultados",
        "search.results_help": "Cantidad de fragmentos a recuperar",
        "search.weight_caption": "ðŸ“ Palabras clave: {kw}% | ðŸŽ¯ Vector: {vec}%",
        "chat.header": "ðŸ’¬ Haz preguntas",
        "chat.input": "Haz una pregunta sobre tus documentosâ€¦",
        "buttons.clear_chat": "ðŸ”„ Limpiar chat",
        "chat.response_metrics": "ðŸ“Š MÃ©tricas de respuesta",
        "chat.metrics_total_time": "Tiempo total: {secs:.2f}s",
        "chat.metrics_first_token": "Primer token: {secs:.2f}s",
        "chat.metrics_tokens": "Tokens: {count}",
        "chat.metrics_speed": "Velocidad: {rate:.1f} tokens/seg",
        "footer.embedding_model": "Modelo de embedding:",
        "footer.generation_model": "Modelo de generaciÃ³n:",
        "chat.metric_response_time": "â±ï¸ Tiempo de respuesta",
        "chat.metric_first_token": "ðŸš€ Primer token",
        "chat.metric_tokens": "ðŸ“ Tokens",
        "chat.metric_speed": "âš¡ Velocidad",
        "chat.searching": "ðŸ” Buscando en los documentosâ€¦",
        "chat.found_chunks": "âœ… {count} fragmentos relevantes en {secs:.2f}s",
        "chat.found_chunks_hybrid": " (HÃ­brido: {kw} palabras clave + {vec} vector)",
        "chat.found_chunks_keyword": " (Palabras clave: {kw} resultados)",
        "chat.found_chunks_vector": " (Vector: {vec} resultados)",
        "chat.sources": "ðŸ“– Fuentes",
        "chat.search_completed": "BÃºsqueda completada en {secs:.2f}s (modo {mode})",
        "chat.thinking": "ðŸ¤” Pensandoâ€¦",
        "chat.streaming": "ðŸ”„ Transmitiendoâ€¦",
        "chat.complete": "âœ… Completado",
        "chat.error_generating": "Error generando la respuesta: {err}",
        "chat.no_relevant": "No encontrÃ© informaciÃ³n relevante en los documentos indexados. AsegÃºrate de indexarlos.",
        "chat.no_relevant_title": "âš ï¸ No se encontraron documentos relevantes",
        "lang.selector": "ðŸŒ Idioma",
        "lang.en": "English",
        "lang.zh_hant": "ç¹é«”ä¸­æ–‡",
        "lang.zh_hans": "ç®€ä½“ä¸­æ–‡",
        "lang.es": "EspaÃ±ol",
        "lang.ja": "æ—¥æœ¬èªž",

        "settings.title": "âš™ï¸ Ajustes",
        "settings.doc_processing": "ðŸ“Š Ajustes de procesamiento de documentos",
        "settings.quick_presets": "ðŸŽ¯ Ajustes rÃ¡pidos",
        "settings.quick_presets_caption": "Optimizado para Notion/Lark, PDFs y docs tÃ©cnicos",
        "settings.preset_meeting": "ðŸ“ Actas/Reuniones",
        "settings.preset_prd": "ðŸ“‹ PRD/Especificaciones",
        "settings.preset_tech": "ðŸ’» DocumentaciÃ³n tÃ©cnica",
        "settings.preset_wiki": "ðŸ“š Wiki/KB",
        "settings.preset_applied_meeting": "ðŸ“ Preajuste aplicado: Reuniones",
        "settings.preset_applied_prd": "ðŸ“‹ Preajuste aplicado: PRD/Especificaciones",
        "settings.preset_applied_tech": "ðŸ’» Preajuste aplicado: DocumentaciÃ³n tÃ©cnica",
        "settings.preset_applied_wiki": "ðŸ“š Preajuste aplicado: Wiki/KB",
        "settings.chunk_size": "ðŸ“ TamaÃ±o de fragmento (caracteres por segmento)",
        "settings.chunk_help": "Para Notion/Lark con contenido mixto: 1500â€“1800 recomendado.",
        "settings.overlap_size": "ðŸ”„ SuperposiciÃ³n (texto compartido entre fragmentos)",
        "settings.overlap_help": "Con bloques de cÃ³digo: usar 300â€“400.",
        "settings.results": "ðŸ” Resultados de bÃºsqueda (fragmentos relevantes)",
        "settings.results_help": "Consultas tÃ©cnicas 5â€“7; Q&A simple 3â€“5.",
        "settings.current_config": "ðŸ“Š ConfiguraciÃ³n actual",
        "settings.metric_chunk": "TamaÃ±o de fragmento",
        "settings.metric_overlap": "SuperposiciÃ³n",
        "settings.metric_results": "Resultados",
        "settings.small_good": "âš ï¸ PequeÃ±o: bueno para Q&A",
        "settings.large_good": "ðŸ“¦ Grande: bueno para cÃ³digo",
        "settings.balanced": "âœ… Equilibrado",
        "settings.overlap_pct": "{pct:.0f}% del tamaÃ±o de fragmento",
        "settings.focused": "ðŸŽ¯ BÃºsqueda enfocada",
        "settings.comprehensive": "ðŸŒ Integral",
        "settings.best_practices": "ðŸ’¡ Buenas prÃ¡cticas",
        "settings.bp_notion_title": "ðŸ“Œ ExportaciÃ³n Notion/Lark:",
        "settings.bp_notion_list": "- Exporta a Markdown (.md)\n- Notion: Settings â†’ Export â†’ Markdown & CSV\n- Lark/Feishu: More â†’ Export â†’ Markdown",
        "settings.bp_reco_title": "ðŸ“Š ConfiguraciÃ³n recomendada:",
        "settings.bp_reco_list": "- Reuniones: 600â€“800, superposiciÃ³n 100\n- PRD/Especificaciones: 1500, superposiciÃ³n 300\n- TÃ©cnica: 1800, superposiciÃ³n 400\n- Wiki/How-to: 1200, superposiciÃ³n 200",
        "settings.prompt": "Prompt",
        "settings.prompt_active": "Archivo de prompt activo:",
        "settings.preview_first300": "Previsualizar primeros 300 caracteres",
        "settings.prompt_not_found": "No se encontrÃ³ el archivo de prompt; se usa el predeterminado.",
        "settings.prompt_could_not_read": "No se pudo leer el prompt: {err}",
        "settings.reload_prompt": "ðŸ” Recargar prompt del sistema",
        "settings.reload_ok": "Prompt recargado.",
        "settings.reload_fail": "Error al recargar: {err}",
        "settings.reload_na": "No es posible recargar el prompt ahora.",
        "settings.models": "Modelos",
        "settings.ollama_prereq": "âš ï¸ Requisitos previos:\n1. Instala Ollama: `brew install ollama`\n2. Inicia: `ollama serve`\n3. Descarga modelos:\n   - `ollama pull embeddinggemma:300m`\n   - `ollama pull gpt-oss:20b`",
        "settings.embed_model": "Modelo de embedding",
        "settings.gen_model": "Modelo generativo",
        "settings.model_help": "AsegÃºrate de que el modelo estÃ© instalado en Ollama",
        "settings.check_ollama": "ðŸ” Verificar estado de Ollama",
    },
    "ja": {
        "app.subtitle": "ç„¡æ–™ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç›¸æ£’ â€” `documents/` ã«å…¥ã‚Œã¦è³ªå•ã™ã‚‹ã ã‘ã€‚",
        "sidebar.document_management": "ðŸ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†",
        "sidebar.documents_folder": "ðŸ“‚ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚©ãƒ«ãƒ€: `./{folder}/`",
        "sidebar.index_new_docs": "ðŸ”„ æ–°ã—ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹",
        "sidebar.found_docs": "{count} ä»¶ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œå‡º",
        "sidebar.auto_detect": "ðŸ¤– AI è‡ªå‹•åˆ¤åˆ¥",
        "sidebar.auto_detect_help": "LLM ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¨®é¡žã¨è¨€èªžã‚’åˆ¤åˆ¥ã—ã¾ã™ã€‚",
        "sidebar.auto_detect_caption1": "âœ¨ å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è§£æžã—ã¦å‡¦ç†ã‚’æœ€é©åŒ–",
        "sidebar.auto_detect_caption2": "ðŸŒ Englishãƒ»ä¸­æ–‡(ç®€/ç¹)ãƒ»EspaÃ±olãƒ»æ—¥æœ¬èªž ã«å¯¾å¿œ",
        "sidebar.no_docs_found": "`./{folder}/` ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
        "sidebar.supported_formats_title": "å¯¾å¿œãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ:",
        "sidebar.vision_support_title": "ðŸŽ¨ ç”»åƒç†è§£:",
        "sidebar.vision_support_detail": "âœ… LLaVA ã«ã‚ˆã‚Š PDF ã®ç”»åƒãƒ»å›³ãƒ»ã‚¹ã‚¯ã‚·ãƒ§ã«å¯¾å¿œ",
        "sidebar.supported_formats_list": "PDFã€Wordã€Markdownã€HTMLã€CSVã€Excelã€JSONã€TXT ãªã©",
        "sidebar.indexed_docs": "ðŸ“Š ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ¸ˆã¿ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ",
        "sidebar.reset_index": "ðŸ§¹ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ",
        "sidebar.reset_index_help": "LanceDB ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤ã¨ Tantivy ã®ã‚¯ãƒªã‚¢",
        "sidebar.no_index_yet": "ã¾ã ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“",
        "sidebar.total_chunks": "åˆè¨ˆãƒãƒ£ãƒ³ã‚¯æ•°",
        "sidebar.reset_ok": "ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚",
        "sidebar.reset_fail": "ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚.lancedb ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤ã—ã¦å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚",
        "sidebar.tantivy_warn": "Tantivy ã‚¯ãƒªã‚¢è­¦å‘Š: {err}",
        "search.header": "ðŸ” æ¤œç´¢è¨­å®š",
        "search.mode": "æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰",
        "search.mode_help": "ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½µç”¨",
        "search.alpha_label": "ãƒ™ã‚¯ãƒˆãƒ« vs ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ é‡ã¿",
        "search.alpha_help": "0 = ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã¿, 1 = ãƒ™ã‚¯ãƒˆãƒ«ã®ã¿, 0.5 = ãƒãƒ©ãƒ³ã‚¹",
        "search.results_label": "çµæžœã®ä»¶æ•°",
        "search.results_help": "å–å¾—ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ–­ç‰‡ã®æ•°",
        "search.weight_caption": "ðŸ“ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: {kw}% | ðŸŽ¯ ãƒ™ã‚¯ãƒˆãƒ«: {vec}%",
        "chat.header": "ðŸ’¬ è³ªå•ã™ã‚‹",
        "chat.input": "ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦è³ªå•â€¦",
        "buttons.clear_chat": "ðŸ”„ ãƒãƒ£ãƒƒãƒˆã‚’ã‚¯ãƒªã‚¢",
        "chat.response_metrics": "ðŸ“Š å¿œç­”ãƒ¡ãƒˆãƒªã‚¯ã‚¹",
        "chat.metrics_total_time": "åˆè¨ˆæ™‚é–“: {secs:.2f}s",
        "chat.metrics_first_token": "æœ€åˆã®ãƒˆãƒ¼ã‚¯ãƒ³: {secs:.2f}s",
        "chat.metrics_tokens": "ãƒˆãƒ¼ã‚¯ãƒ³æ•°: {count}",
        "chat.metrics_speed": "é€Ÿåº¦: {rate:.1f} tokens/ç§’",
        "footer.embedding_model": "Embedding ãƒ¢ãƒ‡ãƒ«:",
        "footer.generation_model": "ç”Ÿæˆãƒ¢ãƒ‡ãƒ«:",
        "chat.metric_response_time": "â±ï¸ å¿œç­”æ™‚é–“",
        "chat.metric_first_token": "ðŸš€ æœ€åˆã®ãƒˆãƒ¼ã‚¯ãƒ³",
        "chat.metric_tokens": "ðŸ“ ãƒˆãƒ¼ã‚¯ãƒ³æ•°",
        "chat.metric_speed": "âš¡ é€Ÿåº¦",
        "chat.searching": "ðŸ” ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ä¸­â€¦",
        "chat.found_chunks": "âœ… é–¢é€£ãƒãƒ£ãƒ³ã‚¯ {count} ä»¶ï¼ˆ{secs:.2f}sï¼‰",
        "chat.found_chunks_hybrid": "ï¼ˆãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ {kw} + ãƒ™ã‚¯ãƒˆãƒ« {vec}ï¼‰",
        "chat.found_chunks_keyword": "ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: {kw} ä»¶ï¼‰",
        "chat.found_chunks_vector": "ï¼ˆãƒ™ã‚¯ãƒˆãƒ«: {vec} ä»¶ï¼‰",
        "chat.sources": "ðŸ“– å‚ç…§å…ƒ",
        "chat.search_completed": "æ¤œç´¢å®Œäº† {secs:.2f}sï¼ˆ{mode} ãƒ¢ãƒ¼ãƒ‰ï¼‰",
        "chat.thinking": "ðŸ¤” è€ƒãˆä¸­â€¦",
        "chat.streaming": "ðŸ”„ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸­â€¦",
        "chat.complete": "âœ… å®Œäº†",
        "chat.error_generating": "å¿œç­”ã®ç”Ÿæˆã§ã‚¨ãƒ©ãƒ¼: {err}",
        "chat.no_relevant": "ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ¸ˆã¿ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«é–¢é€£æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã¾ãšã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã—ã¦ãã ã•ã„ã€‚",
        "chat.no_relevant_title": "âš ï¸ é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
        "lang.selector": "ðŸŒ è¨€èªž",
        "lang.en": "English",
        "lang.zh_hant": "ç¹é«”ä¸­æ–‡",
        "lang.zh_hans": "ç®€ä½“ä¸­æ–‡",
        "lang.es": "EspaÃ±ol",
        "lang.ja": "æ—¥æœ¬èªž",

        "settings.title": "âš™ï¸ è¨­å®š",
        "settings.doc_processing": "ðŸ“Š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‡¦ç†ã®è¨­å®š",
        "settings.quick_presets": "ðŸŽ¯ ã‹ã‚“ãŸã‚“ãƒ—ãƒªã‚»ãƒƒãƒˆ",
        "settings.quick_presets_caption": "Notion/Lark ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€PDFã€æŠ€è¡“æ–‡æ›¸ã«æœ€é©åŒ–",
        "settings.preset_meeting": "ðŸ“ ä¼šè­°ãƒ¡ãƒ¢",
        "settings.preset_prd": "ðŸ“‹ PRD/ä»•æ§˜",
        "settings.preset_tech": "ðŸ’» æŠ€è¡“æ–‡æ›¸",
        "settings.preset_wiki": "ðŸ“š Wiki/ãƒŠãƒ¬ãƒƒã‚¸",
        "settings.preset_applied_meeting": "ðŸ“ é©ç”¨: ä¼šè­°ãƒ¡ãƒ¢",
        "settings.preset_applied_prd": "ðŸ“‹ é©ç”¨: PRD/ä»•æ§˜",
        "settings.preset_applied_tech": "ðŸ’» é©ç”¨: æŠ€è¡“æ–‡æ›¸",
        "settings.preset_applied_wiki": "ðŸ“š é©ç”¨: Wiki/ãƒŠãƒ¬ãƒƒã‚¸",
        "settings.chunk_size": "ðŸ“ ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºï¼ˆ1 ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®æ–‡å­—æ•°ï¼‰",
        "settings.chunk_help": "æ··åœ¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã¯ 1500â€“1800 ã‚’æŽ¨å¥¨ã€‚",
        "settings.overlap_size": "ðŸ”„ ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ï¼ˆãƒãƒ£ãƒ³ã‚¯é–“ã®å…±æœ‰ãƒ†ã‚­ã‚¹ãƒˆï¼‰",
        "settings.overlap_help": "ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚’å«ã‚€æ–‡æ›¸ã¯ 300â€“400 ã‚’æŽ¨å¥¨ã€‚",
        "settings.results": "ðŸ” æ¤œç´¢çµæžœï¼ˆé–¢é€£ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°ï¼‰",
        "settings.results_help": "æŠ€è¡“çš„ãªè³ªå• 5â€“7ã€ç°¡å˜ãª Q&A 3â€“5ã€‚",
        "settings.current_config": "ðŸ“Š ç¾åœ¨ã®è¨­å®š",
        "settings.metric_chunk": "ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º",
        "settings.metric_overlap": "ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—",
        "settings.metric_results": "çµæžœ",
        "settings.small_good": "âš ï¸ å°: Q&A å‘ã‘",
        "settings.large_good": "ðŸ“¦ å¤§: ã‚³ãƒ¼ãƒ‰å‘ã‘",
        "settings.balanced": "âœ… ãƒãƒ©ãƒ³ã‚¹",
        "settings.overlap_pct": "ãƒãƒ£ãƒ³ã‚¯æ¯” {pct:.0f}%",
        "settings.focused": "ðŸŽ¯ é›†ä¸­æ¤œç´¢",
        "settings.comprehensive": "ðŸŒ ç¶²ç¾…çš„",
        "settings.best_practices": "ðŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹",
        "settings.bp_notion_title": "ðŸ“Œ Notion/Lark ã®æ›¸ãå‡ºã—:",
        "settings.bp_notion_list": "- æœ€é«˜ã®çµæžœã«ã¯ Markdown (.md) ã§æ›¸ãå‡ºã—\n- Notion: Settings â†’ Export â†’ Markdown & CSV\n- Lark/Feishu: More â†’ Export â†’ Markdown",
        "settings.bp_reco_title": "ðŸ“Š æŽ¨å¥¨è¨­å®š:",
        "settings.bp_reco_list": "- ä¼šè­°ãƒ¡ãƒ¢: 600â€“800ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ— 100\n- PRD/ä»•æ§˜: 1500ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ— 300\n- æŠ€è¡“æ–‡æ›¸: 1800ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ— 400\n- Wiki/How-to: 1200ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ— 200",
        "settings.prompt": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ",
        "settings.prompt_active": "ä½¿ç”¨ä¸­ã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:",
        "settings.preview_first300": "å…ˆé ­ 300 æ–‡å­—ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼",
        "settings.prompt_not_found": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚",
        "settings.prompt_could_not_read": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ: {err}",
        "settings.reload_prompt": "ðŸ” ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å†èª­ã¿è¾¼ã¿",
        "settings.reload_ok": "å†èª­ã¿è¾¼ã¿ã—ã¾ã—ãŸã€‚",
        "settings.reload_fail": "å†èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: {err}",
        "settings.reload_na": "ä»Šã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å†èª­ã¿è¾¼ã¿ã§ãã¾ã›ã‚“ã€‚",
        "settings.models": "ãƒ¢ãƒ‡ãƒ«",
        "settings.ollama_prereq": "âš ï¸ äº‹å‰æº–å‚™:\n1. Ollama ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: `brew install ollama`\n2. èµ·å‹•: `ollama serve`\n3. ãƒ¢ãƒ‡ãƒ«ã‚’å–å¾—:\n   - `ollama pull embeddinggemma:300m`\n   - `ollama pull gpt-oss:20b`",
        "settings.embed_model": "Embedding ãƒ¢ãƒ‡ãƒ«",
        "settings.gen_model": "ç”Ÿæˆãƒ¢ãƒ‡ãƒ«",
        "settings.model_help": "Ollama ã«ãƒ¢ãƒ‡ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„",
        "settings.check_ollama": "ðŸ” Ollama ã®çŠ¶æ…‹ã‚’ç¢ºèª",
    },
}


def get_locale() -> str:
    return st.session_state.get("locale", "en")


def set_locale(locale: str) -> None:
    if locale in _TRANSLATIONS:
        st.session_state["locale"] = locale


def t(key: str, default: str | None = None, **kwargs) -> str:
    locale = get_locale()
    catalog = _TRANSLATIONS.get(locale, _TRANSLATIONS["en"])  # fallback to en
    text = catalog.get(key)
    if text is None:
        # fallback chain: default -> en -> key
        text = default or _TRANSLATIONS["en"].get(key, key)
    try:
        return text.format(**kwargs)
    except Exception:
        return text
